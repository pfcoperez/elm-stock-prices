<html>
    <head>
        <script type="text/javascript" src="elm.js"></script>
    </head>
    <body>
        <div id="myapp"></div>
    </body>
    <script type="text/javascript">

    var app = Elm.Main.init({
	    node: document.getElementById('myapp')
    });

    // Create your WebSocket.
    // var socket = new WebSocket('wss://echo.websocket.org');
    var socket = new WebSocket('wss://ws.finnhub.io?token=');
    // When a command goes to the `sendMessage` port, we pass the message
    // along to the WebSocket.
    app.ports.sendMessage.subscribe(function(message) {
        console.log("Got message from elm to rely to WS: " + message);
        
        socket.send(message);
    });

    // When a message comes into our WebSocket, we pass the message along
    // to the `messageReceiver` port.
    
    socket.addEventListener("message", function(event) {
        console.log("Passing response to elm: " + event.data)
	    app.ports.messageReceiver.send(event.data);
    });

    </script>
</html>
